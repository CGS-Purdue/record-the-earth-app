#!/usr/bin/env node
'use strict';function _interopDefault(ex){return ex&&typeof ex==='object'&&'default'in ex?ex.default:ex}var React=require('react');var React__default=_interopDefault(React);var PropTypes=_interopDefault(require('prop-types'));var reactNative=require('react-native');function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor){descriptor.writable=true}Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps){_defineProperties(Constructor.prototype,protoProps)}if(staticProps){_defineProperties(Constructor,staticProps)}return Constructor}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly){symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))}keys.push.apply(keys,symbols)}return keys}function _objectSpread2(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function')}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass){_setPrototypeOf(subClass,superClass)}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _possibleConstructorReturn(self,call){if(call&&(typeof call==='object'||typeof call==='function')){return call}return _assertThisInitialized(self)}var ANIMATED_SPRING_FRICTION=6.75;var ANIMATED_SPRING_TENSION=100;var ANIMATED_ELASTIC_DURATION=300;var ANIMATED_ELASTIC_BOUNCINESS=1.2;var ANIMATED_TIMING_OFF=100;var ANIMATED_TIMING_IN=200;var ANIMATED_TIMING_LOADING=3e3;var DEFAULT_RAISE_LEVEL=4;var DEFAULT_ACTIVE_OPACITY=1;var DEFAULT_HEIGHT=60;var DEFAULT_WIDTH=null;var DEFAULT_BORDER_RADIUS=4;var DEFAULT_BORDER_WIDTH=0;var DEFAULT_HORIZONTAL_PADDING=12;var DEFAULT_TEXT_COLOR='#FFFFFF';var DEFAULT_ACTIVITY_COLOR='#FFFFFF';var DEFAULT_BACKGROUND_COLOR='#c0c0c0';var DEFAULT_BACKGROUND_DARKER='#9f9f9f';var DEFAULT_BACKGROUND_SHADOW='rgba(0, 0, 0, 0.15)';var DEFAULT_BACKGROUND_ACTIVE='rgba(0, 0, 0, 0.15)';var DEFAULT_LINE_HEIGHT=20;var DEFAULT_TEXT_SIZE=14;function memoize(fn){var _this=this;memoize.cache={};memoize.size=0;return function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}var key=JSON.stringify(args);if(memoize.cache[key]){return memoize.cache[key]}var value=fn.apply(_this,args);if(memoize.size>1e3){memoize.size=0;memoize.cache={}}memoize.size+=1;memoize.cache[key]=value;return value}}function animateTiming(_ref){var variable=_ref.variable,toValue=_ref.toValue,_ref$duration=_ref.duration,duration=_ref$duration===void 0?ANIMATED_TIMING_IN:_ref$duration,_ref$delay=_ref.delay,delay=_ref$delay===void 0?0:_ref$delay,_ref$easing=_ref.easing,easing=_ref$easing===void 0?reactNative.Easing.easeOut:_ref$easing,_ref$callback=_ref.callback,callback=_ref$callback===void 0?null:_ref$callback;reactNative.Animated.timing(variable,{toValue:toValue,duration:duration,easing:easing,delay:delay,useNativeDriver:true}).start(callback)}function animateSpring(_ref2){var variable=_ref2.variable,toValue=_ref2.toValue,_ref2$delay=_ref2.delay,delay=_ref2$delay===void 0?0:_ref2$delay,_ref2$tension=_ref2.tension,tension=_ref2$tension===void 0?ANIMATED_SPRING_TENSION:_ref2$tension,_ref2$friction=_ref2.friction,friction=_ref2$friction===void 0?ANIMATED_SPRING_FRICTION:_ref2$friction,_ref2$callback=_ref2.callback,callback=_ref2$callback===void 0?null:_ref2$callback;reactNative.Animated.spring(variable,{toValue:toValue,tension:tension,friction:friction,delay:delay,useNativeDriver:true}).start(callback)}function animateElastic(params){animateTiming(_objectSpread2({duration:ANIMATED_ELASTIC_DURATION,easing:reactNative.Easing.elastic(ANIMATED_ELASTIC_BOUNCINESS)},params))}var memoized=memoize((function(_ref){var backgroundActive=_ref.backgroundActive,backgroundColor=_ref.backgroundColor,backgroundDarker=_ref.backgroundDarker,backgroundPlaceholder=_ref.backgroundPlaceholder,backgroundProgress=_ref.backgroundProgress,backgroundShadow=_ref.backgroundShadow,borderColor=_ref.borderColor,borderRadius=_ref.borderRadius,borderWidth=_ref.borderWidth,height=_ref.height,paddingBottom=_ref.paddingBottom,paddingHorizontal=_ref.paddingHorizontal,paddingTop=_ref.paddingTop,raiseLevel=_ref.raiseLevel,stateWidth=_ref.stateWidth,stretch=_ref.stretch,textColor=_ref.textColor,textFontFamily=_ref.textFontFamily,textLineHeight=_ref.textLineHeight,textSize=_ref.textSize,width=_ref.width;var calcHeight=height+paddingBottom+paddingTop;var calcWidth=stretch?'100%':width||stateWidth||null;var dimensionsDiff={width:calcWidth,height:calcHeight-raiseLevel};return reactNative.StyleSheet.create({container:{height:calcHeight,width:calcWidth},container__text:{color:textColor,fontSize:textSize,fontFamily:textFontFamily,paddingBottom:paddingBottom,paddingTop:paddingTop,paddingHorizontal:paddingHorizontal},container__placeholder:{height:textLineHeight,backgroundColor:backgroundPlaceholder},shadow:{bottom:-raiseLevel/2,height:height-raiseLevel,borderRadius:borderRadius,backgroundColor:backgroundShadow},bottom:_objectSpread2({borderRadius:borderRadius,backgroundColor:backgroundDarker},dimensionsDiff),progress:_objectSpread2({},dimensionsDiff,{backgroundColor:backgroundProgress}),content:_objectSpread2({},dimensionsDiff,{borderRadius:borderRadius}),activeBackground:_objectSpread2({},dimensionsDiff,{backgroundColor:backgroundActive}),text:{borderColor:borderColor,borderWidth:borderWidth,borderRadius:borderRadius,backgroundColor:backgroundColor}})}));var getStyles=function getStyles(_ref2){var backgroundActive=_ref2.backgroundActive,backgroundColor=_ref2.backgroundColor,backgroundDarker=_ref2.backgroundDarker,backgroundPlaceholder=_ref2.backgroundPlaceholder,backgroundProgress=_ref2.backgroundProgress,backgroundShadow=_ref2.backgroundShadow,borderColor=_ref2.borderColor,borderRadius=_ref2.borderRadius,borderWidth=_ref2.borderWidth,height=_ref2.height,paddingBottom=_ref2.paddingBottom,paddingHorizontal=_ref2.paddingHorizontal,paddingTop=_ref2.paddingTop,raiseLevel=_ref2.raiseLevel,stateWidth=_ref2.stateWidth,stretch=_ref2.stretch,textColor=_ref2.textColor,textFontFamily=_ref2.textFontFamily,textLineHeight=_ref2.textLineHeight,textSize=_ref2.textSize,width=_ref2.width;return memoized({backgroundActive:backgroundActive,backgroundColor:backgroundColor,backgroundDarker:backgroundDarker,backgroundPlaceholder:backgroundPlaceholder,backgroundProgress:backgroundProgress,backgroundShadow:backgroundShadow,borderColor:borderColor,borderRadius:borderRadius,borderWidth:borderWidth,height:height,paddingBottom:paddingBottom,paddingHorizontal:paddingHorizontal,paddingTop:paddingTop,raiseLevel:raiseLevel,stateWidth:stateWidth,stretch:stretch,textColor:textColor,textFontFamily:textFontFamily,textLineHeight:textLineHeight,textSize:textSize,width:width})};var styles=reactNative.StyleSheet.create({container:{backgroundColor:'transparent',zIndex:10},container__text:{width:'100%',fontWeight:'bold',zIndex:10,textAlign:'center'},container__view:{flexDirection:'row',flex:1,alignItems:'center',justifyContent:'center'},container__placeholder:{width:'55%'},container__activity:{position:'absolute',zIndex:5},shadow:{width:'98%',position:'absolute',left:'1%'},bottom:{position:'absolute',bottom:0,left:0},progress:{zIndex:1,position:'absolute',top:0,left:0},content:{position:'absolute',top:0,left:0},activeBackground:{position:'absolute',top:0,left:0},text:{flex:1,alignItems:'center',justifyContent:'center',zIndex:3,overflow:'hidden'}});var Button=function(_React$Component){_inherits(Button,_React$Component);function Button(props){var _this;_classCallCheck(this,Button);_this=_possibleConstructorReturn(this,_getPrototypeOf(Button).call(this,props));_defineProperty(_assertThisInitialized(_this),'pressIn',(function(){if(_this.props.disabled===true||!_this.props.children||_this.animating===true){return false}_this.pressing=true;if(_this.props.progress){_this.animating=true}animateTiming({variable:_this.animatedValue,toValue:1,duration:ANIMATED_TIMING_OFF});animateTiming({variable:_this.animatedActive,toValue:1,duration:ANIMATED_TIMING_OFF});animateTiming({variable:_this.animatedOpacity,toValue:_this.props.progress?1:_this.props.activeOpacity,duration:ANIMATED_TIMING_OFF,callback:function callback(){_this.pressing=false}})}));_defineProperty(_assertThisInitialized(_this),'pressOut',(function(){if(_this.props.disabled===true||!_this.props.children){return false}if(_this.animating===true){_this.press();return}if(_this.pressing===false){_this.press();_this.release();return}_this.timeout=setTimeout((function(){_this.press();_this.release()}),ANIMATED_TIMING_OFF/2.5)}));_defineProperty(_assertThisInitialized(_this),'press',(function(){if(_this.props.progress===true){_this.animating=true;_this.setState({activity:true},(function(){_this.animateLoadingStart();animateTiming({variable:_this.loadingOpacity,toValue:1});animateElastic({variable:_this.textOpacity,toValue:0});animateElastic({variable:_this.activityOpacity,toValue:1})}))}if(_this.props.onPress){_this.props.onPress(_this.end)}}));_defineProperty(_assertThisInitialized(_this),'end',(function(_callback){if(_this.props.progress===true){if(_this.timeout){clearTimeout(_this.timeout)}_this.timeout=setTimeout((function(){animateTiming({variable:_this.animatedLoading,toValue:1,callback:function callback(){animateElastic({variable:_this.textOpacity,toValue:1});animateElastic({variable:_this.activityOpacity,toValue:0,callback:function callback(){_callback&&_callback()}});animateTiming({variable:_this.loadingOpacity,toValue:0,delay:100,callback:function callback(){_this.release((function(){_this.animating=false}))}})}})}),50)}}));_defineProperty(_assertThisInitialized(_this),'textLayout',(function(event){_this.containerWidth=event.nativeEvent.layout.width;if(_this.props.width===null&&!_this.props.stretch==true){if(_this.state.width!==event.nativeEvent.layout.width&&_this.state.width<event.nativeEvent.layout.width){_this.setState({width:event.nativeEvent.layout.width})}_this.animatedOpacity.setValue(1)}}));_this.loadingOpacity=new reactNative.Animated.Value(1);_this.textOpacity=new reactNative.Animated.Value(1);_this.activityOpacity=new reactNative.Animated.Value(0);_this.animatedActive=new reactNative.Animated.Value(0);_this.animatedValue=new reactNative.Animated.Value(0);_this.animatedLoading=new reactNative.Animated.Value(0);_this.animatedOpacity=new reactNative.Animated.Value(props.width===null&&!props.stretch===true?0:1);_this.layouted=null;_this.animating=false;_this.timeout=null;_this.pressing=false;_this.containerWidth=null;_this.state={activity:false,width:null};return _this}_createClass(Button,[{key:'getAnimatedValues',value:function getAnimatedValues(){var width=this.containerWidth?this.containerWidth*-1:0;return{animatedContainer:{opacity:this.animatedOpacity},animatedShadow:{transform:[{translateY:this.animatedValue.interpolate({inputRange:[0,1],outputRange:[0,-this.props.raiseLevel/2]})}]},animatedContent:{transform:[{translateY:this.animatedValue.interpolate({inputRange:[0,1],outputRange:[0,this.props.raiseLevel]})}]},animatedActive:{opacity:this.animatedActive},animatedActivity:{opacity:this.activityOpacity,transform:[{scale:this.activityOpacity}]},animatedProgress:{opacity:this.loadingOpacity,transform:[{translateX:this.animatedLoading.interpolate({inputRange:[0,1],outputRange:[width,0]})}]}}}},{key:'release',value:function release(callback){if(this.props.springRelease===true){animateSpring({variable:this.animatedActive,toValue:0});animateSpring({variable:this.animatedValue,toValue:0,callback:callback});animateTiming({variable:this.animatedOpacity,toValue:1,duration:ANIMATED_TIMING_OFF});return}animateTiming({variable:this.animatedActive,toValue:0,duration:ANIMATED_TIMING_OFF});animateTiming({variable:this.animatedOpacity,toValue:1,duration:ANIMATED_TIMING_OFF});animateTiming({variable:this.animatedValue,toValue:0,duration:ANIMATED_TIMING_OFF,callback:callback})}},{key:'animateLoadingStart',value:function animateLoadingStart(){this.animatedLoading.setValue(0);animateTiming({variable:this.animatedLoading,toValue:1,duration:this.props.progressLoadingTime})}},{key:'renderContent',value:function renderContent(dynamicStyles){var children=this.props.children;var animatedStyles={opacity:this.textOpacity,transform:[{scale:this.textOpacity}]};if(!children){return React__default.createElement(reactNative.Animated.View,{testID:'aws-btn-content-placeholder',style:[styles.container__placeholder,dynamicStyles.container__placeholder,animatedStyles]})}if(typeof children==='string'){return React__default.createElement(reactNative.Animated.Text,{testID:'aws-btn-content-text',style:[styles.container__text,dynamicStyles.container__text,animatedStyles]},children)}return React__default.createElement(reactNative.Animated.View,{style:[styles.container__view,dynamicStyles.container__view,animatedStyles]},children)}},{key:'render',value:function render(){var animatedValues=this.getAnimatedValues();var dynamicStyles=getStyles(_objectSpread2({},this.props,{stateWidth:this.state.width}));var _this$props=this.props,ExtraContent=_this$props.ExtraContent,style=_this$props.style,activityColor=_this$props.activityColor;return React__default.createElement(reactNative.TouchableWithoutFeedback,{testID:'aws-btn-content-view',onPressIn:this.pressIn,onPressOut:this.pressOut},React__default.createElement(reactNative.Animated.View,{testID:'aws-btn-content-2',style:[styles.container,dynamicStyles.container,animatedValues.animatedContainer,style]},React__default.createElement(reactNative.Animated.View,{testID:'aws-btn-shadow',style:[styles.shadow,dynamicStyles.shadow,animatedValues.animatedShadow]}),React__default.createElement(reactNative.View,{testID:'aws-btn-bottom',style:[styles.bottom,dynamicStyles.bottom]}),React__default.createElement(reactNative.Animated.View,{testID:'aws-btn-content',style:[styles.content,dynamicStyles.content,animatedValues.animatedContent]},React__default.createElement(reactNative.View,{testID:'aws-btn-text',style:[styles.text,dynamicStyles.text],onLayout:this.textLayout},ExtraContent,React__default.createElement(reactNative.Animated.View,{testID:'aws-btn-active-background',style:[styles.activeBackground,dynamicStyles.activeBackground,animatedValues.animatedActive]}),this.state.activity===true&&React__default.createElement(React.Fragment,null,React__default.createElement(reactNative.Animated.View,{testID:'aws-btn-progress',style:[styles.progress,dynamicStyles.progress,animatedValues.animatedProgress]}),React__default.createElement(reactNative.Animated.View,{testID:'aws-btn-activity-indicator',style:[styles.container__activity,animatedValues.animatedActivity]},React__default.createElement(reactNative.ActivityIndicator,{color:activityColor}))),this.renderContent(dynamicStyles)))))}}]);return Button}(React__default.Component);Button.propTypes={activityColor:PropTypes.string,backgroundActive:PropTypes.string,backgroundColor:PropTypes.string,backgroundImage:PropTypes.string,backgroundDarker:PropTypes.string,backgroundPlaceholder:PropTypes.string,backgroundProgress:PropTypes.string,backgroundShadow:PropTypes.string,borderColor:PropTypes.string,borderRadius:PropTypes.number,borderWidth:PropTypes.number,children:PropTypes.node,ExtraContent:PropTypes.node,disabled:PropTypes.bool,height:PropTypes.number,paddingHorizontal:PropTypes.number,onPress:PropTypes.func,progress:PropTypes.bool,paddingBottom:PropTypes.number,raiseLevel:PropTypes.number,springRelease:PropTypes.bool,stretch:PropTypes.bool,style:reactNative.ViewPropTypes.style,textColor:PropTypes.string,textLineHeight:PropTypes.number,textSize:PropTypes.number,textFamily:PropTypes.string,width:PropTypes.number};Button.defaultProps={activityColor:DEFAULT_ACTIVITY_COLOR,activeOpacity:DEFAULT_ACTIVE_OPACITY,backgroundActive:DEFAULT_BACKGROUND_ACTIVE,backgroundColor:DEFAULT_BACKGROUND_COLOR,backgroundDarker:DEFAULT_BACKGROUND_DARKER,backgroundImage:null,backgroundPlaceholder:DEFAULT_BACKGROUND_SHADOW,backgroundProgress:DEFAULT_BACKGROUND_SHADOW,backgroundShadow:DEFAULT_BACKGROUND_SHADOW,borderColor:null,borderRadius:DEFAULT_BORDER_RADIUS,borderWidth:DEFAULT_BORDER_WIDTH,children:null,disabled:false,height:DEFAULT_HEIGHT,paddingHorizontal:DEFAULT_HORIZONTAL_PADDING,onPress:null,progress:false,paddingBottom:0,paddingTop:0,progressLoadingTime:ANIMATED_TIMING_LOADING,raiseLevel:DEFAULT_RAISE_LEVEL,springRelease:true,stretch:false,style:null,textColor:DEFAULT_TEXT_COLOR,textLineHeight:DEFAULT_LINE_HEIGHT,textSize:DEFAULT_TEXT_SIZE,textFontFamily:null,width:DEFAULT_WIDTH};
export { Button as AwesomeButton }
